<div ng-controller="SensorsController">
	<div class="ui inverted dimmer" ng-class="{active: loading}">
		<div class="ui text loader">Loading</div>
	</div>
	<div class="ui divided grid">
		<div class="height wide column">
			<sensor-create label="'Add a new device'" callback="onSensorCreated"></sensor-create>
			<table class="ui very basic selectable table">
				<col style="width: 2%" />
				<col style="width: 19%" />
				<col style="width: 19%" />
				<col style="width: 30%" />
				<col style="width: 30%" />
				<thead>
					<tr>
						<th></th>
						<th>Model number</th>
						<th>Item number</th>
						<th>Targets</th>
						<th>Battery level</th>
					</tr>
				</thead>
				<tr ng-repeat="sensor in sensors" ng-init="enablePowerChart();" class="top aligned" ng-click="showSensor(sensor)" ng-class="{active: (sensor==selectedSensor)}" style="cursor:pointer;">
					<td class="collapsing"></td>
					<td class="ui padded">{{sensor.modelNumber}}</td>
					<td>{{sensor.itemNumber}}</td>
					<td>
						<div ng-repeat="target in sensor.targets">
							<i class="leaf icon" />{{target.name}}
						</div>
					</td>
					<td>
						<div class="ui accordion">
							<div class="title">
								<div data-percent="{{sensor.batteryLevel}}" class="ui progress" style="width:80%">
									<div style="transition-duration: 300ms; width: {{sensor.batteryLevel}}%;" class="bar">
										<div class="progress">{{sensor.batteryLevel}}%</div>
									</div>
								</div>
							</div>
							<div class="content"></div>
						</div>
					</td>
				</tr>
			</table>
		</div>

		<div class="height wide column" ng-if="selectedSensor!=null">
			<h3 class="ui header">{{selectedSensor.itemNumber}}</h3>
			<button class="ui tiny compact basic right floated button" ng-click="deleteSensor(selectedSensor)"><i class="delete icon"></i>Delete</button>
			<!--<button class="ui tiny compact right floated basic button" ng-click="editSensor(selectedSensor)"><i class="edit icon"></i>Edit</button>-->
			<h4 class="ui header">General information</h4>
			<ul>
				<li>Model number : {{selectedSensor.modelNumber}}</li>
				<li>Item number : {{selectedSensor.itemNumber}}</li>
				<li>Targets : <ul><li ng-repeat="target in selectedSensor.targets"><i class="leaf icon" />{{target.name}}</li></ul></li>
				<li>Date added : {{selectedSensor.createdAt | date:'medium'}}</li>
			</ul>
			<h4 class="ui header">Weekly power evolution</h4>
			<pl-chart target-type="'sensor'" target-id="selectedSensor.id" type="'power'" period="'week'" style="width:200px; height:200px;"></pl-chart>
		</div>
	</div>